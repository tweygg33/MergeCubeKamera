<!DOCTYPE html>
<html>
  <head>
    <title>AR.js Anwendung</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>
  </head>
  <body style="margin: 0; overflow: hidden;">
    <a-scene embedded id="scene">
      <!-- Ihr AR-Inhalt hier -->
    </a-scene>

    <script>
      // Dokument geladen
      document.addEventListener('DOMContentLoaded', function() {
        // 1. Kamerazugriff anfordern
        navigator.mediaDevices.getUserMedia({ video: true })
          .then(function(stream) {
            // 2. GerÃ¤te auflisten
            return navigator.mediaDevices.enumerateDevices();
          })
          .then(function(devices) {
            // 2.1 Hauptkamera identifizieren
            var videoDevices = devices.filter(function(device) {
              return device.kind === 'videoinput';
            });

            var mainCamera = null;

            videoDevices.forEach(function(device) {
              var label = device.label.toLowerCase();
              if (label.includes('back') || label.includes('rear')) {
                if (!label.includes('tele') && !label.includes('zoom') && !label.includes('ultra')) {
                  mainCamera = device;
                }
              }
            });

            if (!mainCamera) {
              mainCamera = videoDevices.find(function(device) {
                return device.label.toLowerCase().includes('back') || device.label.toLowerCase().includes('rear');
              });
            }

            if (!mainCamera && videoDevices.length > 0) {
              mainCamera = videoDevices[0];
            }

            if (mainCamera) {
              // 3. AR.js initialisieren
              var sceneEl = document.querySelector('#scene');
              sceneEl.setAttribute('arjs', `sourceType: webcam; deviceId: ${mainCamera.deviceId}`);
            } else {
              console.error('Keine geeignete Kamera gefunden.');
            }
          })
          .catch(function(err) {
            console.error('Fehler:', err);
          });
      });
    </script>
  </body>
</html>
